
  <%= render "layouts/sidebar" %>

  <div class="col-lg-10">
    <h3> Purchase History</h3>
    <div class="divider-horizontal-regular"></div>
    <h4> Classes and Workshops</h4>

    		<table class="table table-hover">
				    <thead>
				        <tr>
				          <th>Name</th>
				          <th>Instructor</th>  
				          <th>Date</th>
				          <th>Start Time</th>
				          <th>Studio</th>
				          <th>Location</th>
				          <th>Cost</th>
				        </tr>
				    </thead>
				    <tbody>
				<% @registered_events = @user.registered_events.where(:attended => false )%>
				<% @registered_events.each do |registered_event| %>

				<% event = Event.find(registered_event.event_id) %>
							<% if event.start_at <= DateTime.now %>
							<tr class="danger">
							<% elsif event.start_at < DateTime.now + 7%>
							<tr class="warning">
							<% else %>
				        	<tr>
				        	<% end %>
				        		<td><%= event.title %></td>
				        		<td><%= event.instructor%></td>
		            			<td><%= event.start_at.to_formatted_s(:rfc822) %> </td>
		            			<td><%= event.start_at.strftime("%I:%M %P") %></td>
				        		<td><%= Studio.find(event.studio_id).name %></td>
				        	</tr>
				        <% end %>
				</table>

    <div class="divider-horizontal-regular"></div>

    <h4> Memberships</h4>


		<table class="table table-hover">
				    <thead>
				        <tr>
				          <th>Name</th>
				          <th>Price</th>  
				          <th>Interval</th>
				          <th>Interval Count</th>
				          <th>Trial Period Days</th>
				        </tr>
				    </thead>
				    <tbody>
				<% @purchases = @user.customer.purchases.where(:product_type => "membership") %>
				<% @purchases.each do |purchase| %>

				<% membership = Membership.find(purchase.product_id) %>
				        	<tr>
				        		<td><%= membership.name %></td>
				        		<td><%= membership.price%></td>
				        		<td><%= membership.interval%>
				        		</td>						
				        		<td><%= membership.interval_count if membership.interval_count?%></td>		        		<td><%= membership.trial_period_days if membership.trial_period_days?%></td>
								<% @edit_membership = membership %>
				        	</tr>
				        <% end %>
				</table>


    <div class="divider-horizontal-regular"></div>
    <h3> Attendance History</h3>
    <div class="divider-horizontal-regular"></div>

	</div>
