
<link rel='stylesheet' type='text/css' href='fullcalendar.css' />
<script type='text/javascript' src='jquery.js'></script>
<script type='text/javascript' src='fullcalendar.js'></script>

<script> 
$(document).ready(function() {

    //NOTE that I am selecting on a class here
    $('#toggle').click(function(e) {
        //You also need to prevent the default behaviour of 
        e.preventDefault();

        $("#map-container").toggle();
    });


$('#calendar').fullCalendar({
	defaultView: 'agendaWeek',
	height: 500,
	header: {
  	left: 'prev,next today',
  	center: 'title',
  	right: 'month,agendaWeek,agendaDay'
  	},
});

});
</script>

<div class="row" style="margin-top:-17px;">

	<% if current_user.present? %>

	<% if current_user.has_role? :owner, :any %>

	<div class="col-lg-2 leftspan" style="margin-top: 10px;">
		<%= render 'layouts/sidebar' %>
	</div>
	<div class="col-lg-8 rightspan" style="min-height:600px;">
		<h3>Welcome to your online studio manager!</h3>

		<!-- This is the content for the studio owner dashboard!
		-->

<a href="https://connect.stripe.com/oauth/authorize?response_type=code&amp;scope=read_write&amp;stripe_landing=login&amp;client_id=ca_2Ksr3KRSkcnkhLjwUQPbFNKuAptJ5sSw" class="stripe-connect"><span>Connect with Stripe</span></a>

	</div>


	<% else %>
	<div class="col-lg-8 col-lg-offset-2">
	<% if current_user.has_role? :student, :any %>
	<!-- Would like to have an icon for the maps so that if the student has a studio they do not have to see the map but they can toggle it at any time. Displays events for primary studio automatically. 
	-->
	<h3>Welcome! Search for your studio on the map and start getting organized.</h3> 
	<p> If you can't find yours send an invitation so that they can sign up for our services. <a> Send Invite </a> </p>
	
	<% end %>

    <%= link_to 'Map view', '', class: 'button', id: "toggle" %>

    <div id="map-container">
	 	<%= gmaps(:map_options => {:do_clustering => false}, :markers => {:data => @json}) %>
	</div>

	<div class="panel panel-primary" >
		<div class="panel-heading">
	        <h5 class="panel-title">List of Classes for <%= current_user.name %> </h5>
	    </div>

		<div id='calendar'></div>
	</br>

		<!-- TO DO: Update calendar with the events for the studio selected (show in muted color). When a class is selected show the payment options in the section below. Have the payment options link to a purchase form. When the student purchases a payment plan this section is only displayed if the payment plan doesn't apply. Otherwise button shows [Register Class] and changes color of event.
		-->

		<div class="row">
  		<div class="col-lg-6" style="padding-right:30px;">
  			<h3> Offers for Studio One </h3>
  			<p> Look through the offered payment options for the classes that you have selected </p>
  		</div>
	  	<div class="col-lg-5" style="margin-top:25px;">
			<div class="panel panel-primary" >
				<div class="panel-heading">
	        		<h5 class="panel-title">Studio Offerings </h5>
	    		</div>
			<ul class="list-group" style="list-style-type:none;">
			  <li><a href="#" class="list-group-item ">
			    <p class="list-group-item-heading">Monthly Membership</p>
			    <!--<p class="list-group-item-text">...</p>--></a></li>
			    <li><a href="#" class="list-group-item">
			    <p class="list-group-item-heading">Drop-In Class</p>
			    <!--<p class="list-group-item-text">...</p>--></a></li>
			</ul>
			</div>
		</div>
		</div>
	</div>

	<% if !current_user.has_role? :owner, :any %>
		<p style="margin-left:100px;"><b>Are you a studio owner?</b> To be able to use our full suite of services please:

	<% if current_user.customer.present? %>
  		<%= link_to 'Create a Studio', new_studio_path(), class: 'btn btn-mini', style: 'margin-top:-3px;' %>
    <% else %>
		<%= link_to 'Add an Account', new_user_account_path(current_user.id), class: 'btn btn-mini', style: 'margin-top:-3px;'  %></p>
		<% end %>
	<% end %>
	<% end %>

	</div>


	<% else %>
		<%= render 'landing_page' %>
	<% end %>
  	</div>
</div>
