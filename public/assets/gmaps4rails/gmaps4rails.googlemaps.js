!function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var s in n)t.call(n,s)&&(e[s]=n[s]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};this.Gmaps4RailsGoogle=function(t){function n(){n.__super__.constructor.apply(this,arguments),this.map_options={disableDefaultUI:!1,disableDoubleClickZoom:!1,type:"ROADMAP"},this.markers_conf={clusterer_gridSize:50,clusterer_maxZoom:5,custom_cluster_pictures:null,custom_infowindow_class:null},this.mergeWithDefault("map_options"),this.mergeWithDefault("markers_conf"),this.kml_options={clickable:!0,preserveViewport:!1,suppressInfoWindows:!1},this.polygons_conf={strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,fillColor:"#000000",fillOpacity:.35,clickable:!1},this.circles_conf={fillColor:"#00AAFF",fillOpacity:.35,strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,clickable:!1,zIndex:null},this.direction_conf={panel_id:null,display_panel:!1,origin:null,destination:null,waypoints:[],optimizeWaypoints:!1,unitSystem:"METRIC",avoidHighways:!1,avoidTolls:!1,region:null,travelMode:"DRIVING"}}return e(n,t),n.prototype.createPoint=function(t,e){return new google.maps.Point(t,e)},n.prototype.createLatLng=function(t,e){return new google.maps.LatLng(t,e)},n.prototype.createLatLngBounds=function(){return new google.maps.LatLngBounds},n.prototype.createMap=function(){var t,e;return t={maxZoom:this.map_options.maxZoom,minZoom:this.map_options.minZoom,zoom:this.map_options.zoom,center:this.createLatLng(this.map_options.center_latitude,this.map_options.center_longitude),mapTypeId:google.maps.MapTypeId[this.map_options.type],mapTypeControl:this.map_options.mapTypeControl,disableDefaultUI:this.map_options.disableDefaultUI,disableDoubleClickZoom:this.map_options.disableDoubleClickZoom,draggable:this.map_options.draggable},e=this.mergeObjectWithDefault(this.map_options.raw,t),new google.maps.Map(document.getElementById(this.map_options.id),e)},n.prototype.createMarkerImage=function(t,e,n,i,s){return new google.maps.MarkerImage(t,e,n,i,s)},n.prototype.createSize=function(t,e){return new google.maps.Size(t,e)},n.prototype.createMarker=function(t){var e,n,i,s,o,r,a;return s=this.createLatLng(t.Lat,t.Lng),""===t.marker_picture&&null===t.rich_marker?(e={position:s,map:this.serviceObject,title:t.marker_title,draggable:t.marker_draggable,zIndex:t.zindex},o=this.mergeObjectWithDefault(this.markers_conf.raw,e),new google.maps.Marker(o)):null!==t.rich_marker?new RichMarker({position:s,map:this.serviceObject,draggable:t.marker_draggable,content:t.rich_marker,flat:null===t.marker_anchor?!1:t.marker_anchor[1],anchor:null===t.marker_anchor?0:t.marker_anchor[0],zIndex:t.zindex}):(n=this.createImageAnchorPosition(t.marker_anchor),r=this.createImageAnchorPosition(t.shadow_anchor),i=this.createOrRetrieveImage(t.marker_picture,t.marker_width,t.marker_height,n),a=this.createOrRetrieveImage(t.shadow_picture,t.shadow_width,t.shadow_height,r),e={position:s,map:this.serviceObject,icon:i,title:t.marker_title,draggable:t.marker_draggable,shadow:a,zIndex:t.zindex},o=this.mergeObjectWithDefault(this.markers_conf.raw,e),new google.maps.Marker(o))},n.prototype.includeMarkerImage=function(t,e){var n,i,s,o;for(n=s=0,o=t.length;o>s;n=++s)if(i=t[n],i.url===e)return n;return!1},n.prototype.createOrRetrieveImage=function(t,e,n,i){var s,o;if(""===t||null===t)return null;switch(o=this.includeMarkerImage(this.markerImages,t)){case!1:return s=this.createMarkerImage(t,this.createSize(e,n),null,i,null),this.markerImages.push(s),s;default:return"number"==typeof o?this.markerImages[o]:!1}},n.prototype.clearMarkers=function(){var t,e,n,i,s;for(i=this.markers,s=[],e=0,n=i.length;n>e;e++)t=i[e],s.push(this.clearMarker(t));return s},n.prototype.showMarkers=function(){var t,e,n,i,s;for(i=this.markers,s=[],e=0,n=i.length;n>e;e++)t=i[e],s.push(this.showMarker(t));return s},n.prototype.hideMarkers=function(){var t,e,n,i,s;for(i=this.markers,s=[],e=0,n=i.length;n>e;e++)t=i[e],s.push(this.hideMarker(t));return s},n.prototype.clearMarker=function(t){return t.serviceObject.setMap(null)},n.prototype.showMarker=function(t){return t.serviceObject.setVisible(!0)},n.prototype.hideMarker=function(t){return t.serviceObject.setVisible(!1)},n.prototype.extendBoundsWithMarkers=function(){var t,e,n,i,s;for(i=this.markers,s=[],e=0,n=i.length;n>e;e++)t=i[e],s.push(this.boundsObject.extend(t.serviceObject.position));return s},n.prototype.createClusterer=function(t){return new MarkerClusterer(this.serviceObject,t,{maxZoom:this.markers_conf.clusterer_maxZoom,gridSize:this.markers_conf.clusterer_gridSize,styles:this.customClusterer()})},n.prototype.clearClusterer=function(){return this.markerClusterer.clearMarkers()},n.prototype.clusterize=function(){var t,e,n,i,s;if(this.markers_conf.do_clustering===!0){for(null!==this.markerClusterer&&this.clearClusterer(),e=new Array,s=this.markers,n=0,i=s.length;i>n;n++)t=s[n],e.push(t.serviceObject);return this.markerClusterer=this.createClusterer(e)}},n.prototype.createInfoWindow=function(t){var e,n;return"function"==typeof this.jsTemplate||null!=t.description?("function"==typeof this.jsTemplate&&(t.description=this.jsTemplate(t)),null!==this.markers_conf.custom_infowindow_class?(e=document.createElement("div"),e.setAttribute("class",this.markers_conf.custom_infowindow_class),e.innerHTML=t.description,t.infowindow=new InfoBox(this.infobox(e)),n=this,google.maps.event.addListener(t.serviceObject,"click",this.openInfoWindow(n,t.infowindow,t.serviceObject))):(t.infowindow=new google.maps.InfoWindow({content:t.description}),n=this,google.maps.event.addListener(t.serviceObject,"click",this.openInfoWindow(n,t.infowindow,t.serviceObject)))):void 0},n.prototype.openInfoWindow=function(t,e,n){return function(){return null!==t.visibleInfoWindow&&t.visibleInfoWindow.close(),e.open(t.serviceObject,n),t.visibleInfoWindow=e}},n.prototype.createKmlLayer=function(t){var e;return e=t.options||{},e=this.mergeObjectWithDefault(e,this.kml_options),t=new google.maps.KmlLayer(t.url,e),t.setMap(this.serviceObject),t},n.prototype.create_polyline=function(t){var e,n,i,s,o,r,a,l,c,u,h,d,f,p,g;for(a=[],d=0,p=t.length;p>d;d++)if(i=t[d],null!=i.coded_array)for(n=new google.maps.geometry.encoding.decodePath(i.coded_array),f=0,g=n.length;g>f;f++)r=n[f],a.push(r);else i===t[0]&&(l=i.strokeColor||this.polylines_conf.strokeColor,c=i.strokeOpacity||this.polylines_conf.strokeOpacity,u=i.strokeWeight||this.polylines_conf.strokeWeight,e=i.clickable||this.polylines_conf.clickable,h=i.zIndex||this.polylines_conf.zIndex),null!=i.lat&&null!=i.lng&&(s=this.createLatLng(i.lat,i.lng),a.push(s));return o=new google.maps.Polyline({path:a,strokeColor:l,strokeOpacity:c,strokeWeight:u,clickable:e,zIndex:h}),t.serviceObject=o,o.setMap(this.serviceObject)},n.prototype.updateBoundsWithPolylines=function(){var t,e,n,i,s,o,r;for(o=this.polylines,r=[],i=0,s=o.length;s>i;i++)e=o[i],n=e.serviceObject.latLngs.getArray()[0].getArray(),r.push(function(){var e,i,s;for(s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.boundsObject.extend(t));return s}.call(this));return r},n.prototype.create_kml=function(){var t,e,n,i,s;for(i=this.kml,s=[],e=0,n=i.length;n>e;e++)t=i[e],s.push(t.serviceObject=this.createKmlLayer(t));return s},n.prototype.fitBounds=function(){return this.boundsObject.isEmpty()?void 0:this.serviceObject.fitBounds(this.boundsObject)},n.prototype.centerMapOnUser=function(){return this.serviceObject.setCenter(this.userLocation)},n.prototype.updateBoundsWithPolygons=function(){var t,e,n,i,s,o,r;for(o=this.polygons,r=[],i=0,s=o.length;s>i;i++)e=o[i],n=e.serviceObject.latLngs.getArray()[0].getArray(),r.push(function(){var e,i,s;for(s=[],e=0,i=n.length;i>e;e++)t=n[e],s.push(this.boundsObject.extend(t));return s}.call(this));return r},n.prototype.updateBoundsWithCircles=function(){var t,e,n,i,s;for(i=this.circles,s=[],e=0,n=i.length;n>e;e++)t=i[e],this.boundsObject.extend(t.serviceObject.getBounds().getNorthEast()),s.push(this.boundsObject.extend(t.serviceObject.getBounds().getSouthWest()));return s},n.prototype.extendMapBounds=function(){var t,e,n,i,s;for(i=this.map_options.bounds,s=[],e=0,n=i.length;n>e;e++)t=i[e],s.push(this.boundsObject.extend(this.createLatLng(t.lat,t.lng)));return s},n.prototype.adaptMapToBounds=function(){var t;return this.map_options.auto_zoom?this.fitBounds():(t=this.boundsObject.getCenter(),this.map_options.center_latitude=t.lat(),this.map_options.center_longitude=t.lng(),this.serviceObject.setCenter(t))},n}(Gmaps4Rails)}.call(this);